<!DOCTYPE html>
<html class="no-js">
  <head>
	<meta charset="utf-8">
	<title>[deisgn Pattern Series] 02 Composite | newkayak12.github.io</title>
	<meta name="description"
		content="from Dictionary - Composite">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- CSS -->
	<link rel="stylesheet" href="/assets/css/main.css">

	<!--Favicon-->
	<link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">

	<!-- Canonical -->
	<link rel="canonical" href="/design_pattern/2024/05/19/deisgn-pattern-series-02-Composite.html">

	<!-- RSS -->
	<link rel="alternate" type="application/atom+xml" title="newkayak12.github.io"
		href="/feed.xml" />

	<!-- Font Awesome -->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"
		integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">

	<!-- Google Fonts -->
	
	<link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,700italic,400italic" rel="stylesheet"
		type="text/css">
	

	<!-- KaTeX -->
	
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css"
		integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">

	<script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js"
		integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ"
		crossorigin="anonymous"></script>
	

	<!-- Google Analytics -->
	
</head>
  <body>
    <header class="site-header">
	<div class="branding">
		
		<a href="/">
			<img class="avatar" src="/assets/img/avatar.jpeg" alt=""/>
		</a>
		
		<h1 class="site-title">
			<a href="/">newkayak12.github.io</a>
		</h1>
	</div>
	<nav class="site-nav">
		<ul>
			
			
			
			
			
			<li>
				<a class="page-link" href="/about/">
					About
				</a>
			</li>
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			
			<!-- Social icons from Font Awesome, if enabled  -->
			


<li>
	<a href="mailto:newkayak12@gmail.com" title="Email">
		<i class="fas fa-fw fa-envelope"></i>
	</a>
</li>













<li>
	<a href="https://github.com/newkayak12" title="Follow on GitHub">
		<i class="fab fa-fw fa-github"></i>
	</a>
</li>































            <!-- Search bar -->
            
		</ul>
	</nav>

</header>

    <div class="content">
      <article >
  <header style="background-image: url('/')">
    <h1 class="title">[deisgn Pattern Series] 02 Composite</h1>
    
    <p class="meta">
      May 19, 2024
      
    </p>
  </header>
  <section class="post-content"><p>from <a href="https://github.com/newkayak12/Dictionary/blob/master/java/designPattern/02.Composite.md">Dictionary - Composite</a></p>

<h1 id="composite">Composite</h1>
<p>합체 패턴(Composite Pattern)은 복합 객체(Composite) 와 단일 객체(Leaf)를 동일한 컴포넌트로 취급하여, 
클라이언트에게 이 둘을 구분하지 않고 동일한 인터페이스를 사용하도록 하는 구조 패턴이다.</p>

<p>복합체 패턴은 전체-부분의 관계를 갖는 객체들 사이의 관계를 트리 계층 구조로 정의해야 할때 유용하다.
윈도우나 리눅스의 파일 시스템 구조를 떠올려보면 쉽게 이해할 수 있다.</p>

<p>폴더(디렉토리) 안에는 파일이 들어 있을수도 있고 파일을 담은 또 다른 폴더도 들어있을 수 있다.
이를 복합적으로 담을수 있다 해서 Composite 객체라고 불리운다. 반면 파일은 단일 객체 이기 때문에 이를 Leaf 객체라고 불리운다. 즉 Leaf는 자식이 없다.</p>

<p><img src="/assets/img/composite.png" alt="" /></p>

<p>복합체 패턴은 바로 이 폴더와 파일을 동일한 타입으로 취급하여 구현을 단순화 시키는 것이 목적이다.
폴더 안에는 파일 뿐만 아니라 서브 폴더가 올수 있고 또 서브 폴더안에 서브 폴더가 오고.. 
이런식으로 계층 구조를 구현하다 보면, 자칫 복잡해 질 수 도 있는 복합 객체를 재귀 동작을 통해 하위 객체들에게 작업을 위임한다. 
그러면 복합 객체와 단일 객체를 대상으로 똑같은 작업을 적용할 수 있어 단일 / 복합 객체를 구분할 필요가 거의 없어진다.</p>

<h1 id="패턴">패턴</h1>

<p><img src="/assets/img/compositePattern.png" alt="" /></p>

<ul>
  <li>Component : Leaf와 Compsite 를 묶는 공통적인 상위 인터페이스</li>
  <li>Composite : 복합 객체로서, Leaf 역할이나 Composite 역할을 넣어 관리하는 역할을 한다.
    <ul>
      <li>Component 구현체들을 내부 리스트로 관리한다</li>
      <li>add 와 remove 메소드는 내부 리스트에 단일 / 복합 객체를 저장</li>
      <li>Component 인터페이스의 구현 메서드인 operation은 복합 객체에서 호출되면 재귀 하여, 추가 단일 객체를 저장한 하위 복합 객체를 순회하게 된다.</li>
    </ul>
  </li>
  <li>Leaf: 단일 객체로서, 단순하게 내용물을 표시하는 역할을 한다.</li>
  <li>Component 인터페이스의 구현 메서드인 operation은 단일 객체에서 호출되면 적절한 값만 반환한다</li>
  <li>Client : 클라이언트는 Component를 참조하여 단일 / 복합 객체를 하나의 객체로서 다룬다.</li>
</ul>

<h1 id="패턴-흐름">패턴 흐름</h1>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Component 인터페이스</span>
<span class="kd">interface</span> <span class="nc">ItemComponent</span> <span class="o">{</span>
    <span class="kt">int</span> <span class="nf">getPrice</span><span class="o">();</span>
    <span class="nc">String</span> <span class="nf">getName</span><span class="o">();</span>
<span class="o">}</span>
<span class="c1">// Composite 객체</span>
<span class="kd">class</span> <span class="nc">Bag</span> <span class="kd">implements</span> <span class="nc">ItemComponent</span> <span class="o">{</span>
    <span class="c1">// 아이템들과 서브 가방 모두를 저장하기 위해 인터페이스 타입 리스트로 관리</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">ItemComponent</span><span class="o">&gt;</span> <span class="n">components</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>

    <span class="nc">String</span> <span class="n">name</span><span class="o">;</span> <span class="c1">// 가방 이름</span>

    <span class="kd">public</span> <span class="nf">Bag</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="c1">// 리스트에 아이템 &amp; 가방 추가</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">add</span><span class="o">(</span><span class="nc">ItemComponent</span> <span class="n">item</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">components</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">item</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="c1">// 현재 가방의 내용물을 반환</span>
    <span class="kd">public</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">ItemComponent</span><span class="o">&gt;</span> <span class="nf">getComponents</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">components</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getPrice</span><span class="o">()</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">sum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>

        <span class="k">for</span> <span class="o">(</span><span class="nc">ItemComponent</span> <span class="n">component</span> <span class="o">:</span> <span class="n">components</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">// 만일 리스트에서 가져온 요소가 Item이면 정수값을 받을 것이고, Bag이면 '재귀 함수' 동작이 되게 된다 ☆</span>
            <span class="n">sum</span> <span class="o">+=</span> <span class="n">component</span><span class="o">.</span><span class="na">getPrice</span><span class="o">();</span> <span class="c1">// 자기 자신 호출(재귀)</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">sum</span><span class="o">;</span> <span class="c1">// 그렇게 재귀적으로 돌아 하위 아이템들의 값을 더하고 반환하게 된다.</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
<span class="c1">// Leaf 객체</span>
<span class="kd">class</span> <span class="nc">Item</span> <span class="kd">implements</span> <span class="nc">ItemComponent</span> <span class="o">{</span>
    <span class="nc">String</span> <span class="n">name</span><span class="o">;</span> <span class="c1">// 아이템 이름</span>
    <span class="kt">int</span> <span class="n">price</span><span class="o">;</span> <span class="c1">// 아이템 가격</span>

    <span class="kd">public</span> <span class="nf">Item</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="kt">int</span> <span class="n">price</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">price</span> <span class="o">=</span> <span class="n">price</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getPrice</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">price</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>



<span class="kd">class</span> <span class="nc">Client</span> <span class="o">{</span>
    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>

        <span class="c1">// 1. 메인 가방 인스턴스 생성</span>
        <span class="nc">Bag</span> <span class="n">bag_main</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Bag</span><span class="o">(</span><span class="s">"메인 가방"</span><span class="o">);</span>

        <span class="c1">// 2. 아이템 인스턴스 생성</span>
        <span class="nc">Item</span> <span class="n">armor</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Item</span><span class="o">(</span><span class="s">"갑옷"</span><span class="o">,</span> <span class="mi">250</span><span class="o">);</span>
        <span class="nc">Item</span> <span class="n">sword</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Item</span><span class="o">(</span><span class="s">"장검"</span><span class="o">,</span> <span class="mi">500</span><span class="o">);</span>

        <span class="c1">// 3. 메인 가방에는 모험에 필요한 무구 아이템만을 추가</span>
        <span class="n">bag_main</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">armor</span><span class="o">);</span>
        <span class="n">bag_main</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">sword</span><span class="o">);</span>

        <span class="c1">// 4. 서브 가방 인스턴스 생성</span>
        <span class="nc">Bag</span> <span class="n">bag_food</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Bag</span><span class="o">(</span><span class="s">"음식 가방"</span><span class="o">);</span>

        <span class="c1">// 5. 아이템 인스턴스 생성</span>
        <span class="nc">Item</span> <span class="n">apple</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Item</span><span class="o">(</span><span class="s">"사과"</span><span class="o">,</span> <span class="mi">400</span><span class="o">);</span>
        <span class="nc">Item</span> <span class="n">banana</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Item</span><span class="o">(</span><span class="s">"바나나"</span><span class="o">,</span> <span class="mi">130</span><span class="o">);</span>

        <span class="c1">// 6. 서브 가방에는 음식 아이템만을 추가</span>
        <span class="n">bag_food</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">apple</span><span class="o">);</span>
        <span class="n">bag_food</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">banana</span><span class="o">);</span>

        <span class="c1">// 7. 서브 가방을 메인 가방에 넣음</span>
        <span class="n">bag_main</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">bag_food</span><span class="o">);</span>

        <span class="c1">// ----------------------------------------------------- //</span>

        <span class="nc">Client</span> <span class="n">client</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Client</span><span class="o">();</span>

        <span class="c1">// 가방 안에 있는 모든 아이템의 총 값어치를 출력 (가방안에 아이템 뿐만 아니라 서브 가방도 들어있음)</span>
        <span class="n">client</span><span class="o">.</span><span class="na">printPrice</span><span class="o">(</span><span class="n">bag_main</span><span class="o">);</span>

        <span class="c1">// 서브 가방 안에 있는 모든 아이템의 총 값어치를 출력</span>
        <span class="n">client</span><span class="o">.</span><span class="na">printPrice</span><span class="o">(</span><span class="n">bag_food</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">printPrice</span><span class="o">(</span><span class="nc">ItemComponent</span> <span class="n">bag</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">int</span> <span class="n">result</span> <span class="o">=</span> <span class="n">bag</span><span class="o">.</span><span class="na">getPrice</span><span class="o">();</span>
        <span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">bag</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">"의 아이템 총합 : "</span> <span class="o">+</span> <span class="n">result</span> <span class="o">+</span> <span class="s">" 골드"</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>

</code></pre></div></div>

<h1 id="패턴-특징">패턴 특징</h1>
<h2 id="사용-시기">사용 시기</h2>
<ul>
  <li>데이터를 다룰때 계층적 트리 표현을 다루어야 할때</li>
  <li>복잡하고 난해한 단일 / 복합 객체 관계를 간편히 단순화하여 균일하게 처리하고 싶을때</li>
</ul>

<h2 id="장점">장점</h2>
<ul>
  <li>단일체와 복합체를 동일하게 여기기 때문에 묶어서 연산하거나 관리할 때 편리하다.</li>
  <li>다형성 재귀를 통해 복잡한 트리 구조를 보다 편리하게 구성 할 수 있다.</li>
  <li>수평적, 수직적 모든 방향으로 객체를 확장할 수 있다.</li>
  <li>새로운 Leaf 클래스를 추가하더라도 클라이언트는 추상화된 인터페이스 만을 바라보기 때문에 개방 폐쇄 원칙(OCP)Visit Website을 준수 한다. (단일 부분의 확장이 용이)</li>
</ul>

<h2 id="단점">단점</h2>
<ul>
  <li>재귀 호출 특징 상 트리의 깊이(depth)가 깊어질 수록 디버깅에 어려움이 생긴다.</li>
  <li>설계가 지나치게 범용성을 갖기 때문에 새로운 요소를 추가할 때 복합 객체에서 구성 요소에 제약을 갖기 힘들다.</li>
  <li>계층형 구조에서 leaf 객체와 composite 객체들을 모두 동일한 인터페이스로 다루어야하는데, 이 공통 인터페이스 설계가 까다로울 수 있다.
    <ul>
      <li>복합 객체가 가지는 부분 객체의 종류를 제한할 필요가 있을 때</li>
      <li>수평적 방향으로만 확장이 가능하도록 Leaf를 제한하는 Composite를 만들때</li>
    </ul>
  </li>
</ul>

</section>
  

</article>

<!-- Disqus -->


<!-- Post navigation -->

  <div id="post-nav">
  
  <div id="previous-post" class="post-nav-post">
      <p>Previous post</p>
      <a href="/design_pattern/2024/05/19/deisgn-pattern-series-01-ChainOfResponsibility.html">
        [deisgn Pattern Series] 01 Chainofresponsibility
      </a>
  </div>
  
  
  <div id="next-post" class="post-nav-post">
      <p>Next post</p>
      <a href="/design_pattern/2024/05/19/deisgn-pattern-series-03-FlyWeight.html">
        [deisgn Pattern Series] 03 Flyweight
      </a>
  </div>
  
</div>



    </div>
    
<script src="/assets/js/katex_init.js"></script>



<footer class="site-footer">
	<p class="text">Powered by <a href="https://jekyllrb.com/">Jekyll</a> with <a href="https://github.com/rohanchandra/type-theme">Type Theme</a>
</p>
</footer>


  </body>
</html>
